# Модель потоков

Понимание модели потоков критически важно для написания стабильных приложений.

## Цикл событий (Event Loop)

SDK использует C-циклы событий для сетевого ввода-вывода и операций консенсуса.
Ваш Python код взаимодействует с этими внутренними циклами.

## GIL (Global Interpreter Lock)

Так как в Python есть GIL, только один поток Python может выполнять байт-код в один момент времени.
Когда SDK вызывает Python callback:
1.  Оно захватывает GIL.
2.  Выполняет Python функцию.
3.  Освобождает GIL.

## Последствия

*   **Блокирующие операции**: НЕ выполняйте долгие блокирующие операции (например, `time.sleep` или тяжелые вычисления) в колбэках. Это может заблокировать обработку событий SDK!
*   **Async/Await**: `asyncio` Python пока нативно не интегрирован с C циклом событий SDK, но вы можете использовать потоки для тяжелых задач.
*   **Безопасность потоков**: Объекты SDK оборачивают C структуры. Доступ к одному и тому же C объекту из нескольких потоков Python *одновременно* без блокировок может быть небезопасным, в зависимости от реализации конкретного объекта в C.

## Рекомендации

1.  Делайте колбэки максимально быстрыми.
2.  Выносите тяжелую обработку в отдельные потоки Python или процессы.
3.  Используйте GDB (Global Database) для сохранения состояния и обработки конкурентности через его API.

