{
  "version": "2.0",
  "template_version": "1.0",
  "created": "2025-07-18T19:51:59.731072",
  "description": "Критическая задача исправления системы сборки DAP SDK",
  "task_data": {
    "id": "TASK_20250718_195159",
    "title": "Исправление системы сборки DAP SDK: циклические зависимости и заголовочные файлы",
    "description": "Полное исправление системы сборки DAP SDK с устранением циклических зависимостей и корректной настройкой включений заголовочных файлов для обеспечения работы standalone python-dap в динамическом режиме",
    "category": "infrastructure", 
    "priority": "CRITICAL",
    "status": "ACTIVE",
    "progress": 20,
    "metadata": {
      "created": "2025-07-18T19:51:59.731072",
      "updated": "2025-07-18T19:52:00.000000",
      "assigned_to": "Claude AI Assistant",
      "estimated_duration": "4-6 часов",
      "actual_duration": null,
      "start_date": "2025-07-18",
      "target_completion": "2025-07-18"
    },
    "context": {
      "related_modules": [
        "dap_core",
        "dap_crypto", 
        "dap_io",
        "dap_stream",
        "dap_stream_ch",
        "dap_client",
        "dap_session",
        "dap_enc_server",
        "dap_http_server",
        "dap_global_db"
      ],
      "dependencies": [
        "Universal Build System DAP SDK",
        "OBJECT libraries architecture",
        "Include directories setup",
        "External dependencies management"
      ],
      "files_involved": [
        "plugins/plugin-python/python-dap/dap-sdk/CMakeLists.txt",
        "plugins/plugin-python/python-dap/dap-sdk/*/CMakeLists.txt",
        "plugins/plugin-python/python-dap/dap-sdk/net/*/CMakeLists.txt",
        "plugins/plugin-python/python-dap/dap-sdk/net/stream/*/CMakeLists.txt",
        "plugins/plugin-python/python-dap/dap-sdk/net/server/*/CMakeLists.txt"
      ],
      "related_tasks": [
        "Универсальная система сборки DAP SDK (завершена)",
        "Python-DAP standalone testing (блокирована)"
      ]
    },
    "objectives": {
      "primary_goal": "Обеспечить успешную сборку python-dap в динамическом режиме с embedded static DAP SDK без циклических зависимостей и ошибок компиляции",
      "success_criteria": [
        "Успешная конфигурация CMake без циклических зависимостей",
        "Успешная компиляция всех модулей DAP SDK",
        "Корректная работа include директорий между модулями",
        "Успешная сборка финальной библиотеки python_dap.so",
        "Прохождение базовых тестов import библиотеки"
      ],
      "acceptance_criteria": [
        "make -j$(nproc) завершается успешно без ошибок",
        "python3 -c 'import python_dap' работает без ошибок",
        "Все модули DAP SDK корректно линкуются в финальную библиотеку"
      ]
    },
    "implementation_plan": {
      "phases": [
        {
          "phase": 1,
          "title": "Анализ и каталогизация проблем",
          "description": "Детальный анализ всех выявленных ошибок сборки и их причин",
          "estimated_time": "1 час",
          "deliverables": [
            "Список всех циклических зависимостей",
            "Список отсутствующих заголовочных файлов",
            "Карта зависимостей между модулями"
          ],
          "status": "COMPLETED"
        },
        {
          "phase": 2,
          "title": "Исправление include директорий",
          "description": "Настройка корректных путей к заголовочным файлам для всех модулей",
          "estimated_time": "2 часа",
          "deliverables": [
            "Исправленные target_include_directories во всех CMakeLists.txt",
            "Настройка путей к XKCP заголовкам",
            "Настройка путей к uthash заголовкам",
            "Настройка путей к core заголовкам"
          ],
          "status": "IN_PROGRESS"
        },
        {
          "phase": 3,
          "title": "Устранение циклических зависимостей",
          "description": "Полное устранение всех циклических зависимостей между модулями",
          "estimated_time": "1.5 часа",
          "deliverables": [
            "Исправленные зависимости dap_stream ↔ dap_stream_ch ↔ dap_client",
            "Корректная настройка зависимостей для OBJECT библиотек",
            "Обновленная система сбора внешних зависимостей"
          ],
          "status": "PARTIALLY_COMPLETED"
        },
        {
          "phase": 4,
          "title": "Тестирование и валидация",
          "description": "Проверка корректности исправлений и работы системы сборки",
          "estimated_time": "1 час",
          "deliverables": [
            "Успешная сборка в debug режиме",
            "Успешная сборка в release режиме", 
            "Базовые тесты import модуля",
            "Верификация архитектуры финальной библиотеки"
          ],
          "status": "PLANNED"
        },
        {
          "phase": 5,
          "title": "Документация и коммит",
          "description": "Документирование изменений и коммит исправлений",
          "estimated_time": "30 минут",
          "deliverables": [
            "Документация по исправленной архитектуре",
            "Коммит с описанием всех изменений",
            "Обновление README по сборке"
          ],
          "status": "PLANNED"
        }
      ],
      "milestones": [
        {
          "milestone": "Устранение всех ошибок компиляции",
          "deadline": "2025-07-18",
          "criteria": "make завершается без ошибок"
        },
        {
          "milestone": "Успешная сборка python_dap.so",
          "deadline": "2025-07-18", 
          "criteria": "Библиотека создается и может быть импортирована"
        }
      ]
    },
    "identified_problems": {
      "cyclic_dependencies": [
        "dap_stream → dap_stream_ch → dap_client → dap_stream (cycle)",
        "OBJECT libraries trying to link with each other",
        "target_link_libraries between OBJECT targets"
      ],
      "missing_headers": [
        "dap_common.h not found in network modules",
        "uthash.h not found in io and stream modules", 
        "utlist.h not found in io modules",
        "KeccakHash.h not found in crypto-dependent modules",
        "dap_server.h missing for http_server",
        "dap_net.h missing for client modules",
        "dap_http_client.h missing for client",
        "dap_stream_ch_proc.h missing for client"
      ],
      "architecture_issues": [
        "OBJECT libraries created with old add_library syntax",
        "Include directories not propagated to OBJECT libraries",
        "External dependencies not collected properly",
        "XKCP paths not configured for dependent modules"
      ]
    },
    "testing_requirements": {
      "unit_tests": "Не требуется - фокус на исправлении системы сборки",
      "integration_tests": "Проверка успешной сборки всей цепочки модулей",
      "performance_tests": "Базовая проверка времени сборки", 
      "security_tests": "Не применимо к данной задаче"
    },
    "risks_and_mitigations": [
      {
        "risk": "Нарушение существующей функциональности при исправлении зависимостей",
        "probability": "MEDIUM",
        "impact": "HIGH",
        "mitigation": "Поэтапное тестирование каждого исправления, сохранение backup"
      },
      {
        "risk": "Появление новых циклических зависимостей при исправлении include путей",
        "probability": "LOW",
        "impact": "MEDIUM", 
        "mitigation": "Тщательный анализ зависимостей перед каждым изменением"
      },
      {
        "risk": "Проблемы совместимости с существующей архитектурой OBJECT библиотек",
        "probability": "LOW",
        "impact": "MEDIUM",
        "mitigation": "Следование установленному паттерну universal build system"
      }
    ],
    "progress_tracking": {
      "completed_phases": [1],
      "current_phase": 2,
      "blockers": [
        "Множественные отсутствующие заголовочные файлы в сетевых модулях",
        "Неправильная настройка include директорий для OBJECT библиотек"
      ],
      "achievements": [
        "Успешно исправлены основные циклические зависимости между core модулями",
        "Создана система отложенных зависимостей через cache переменные",
        "Переведены основные модули на универсальную систему OBJECT библиотек"
      ],
      "lessons_learned": [
        "OBJECT библиотеки требуют другого подхода к include директориям чем STATIC",
        "Циклические зависимости в DAP SDK глубже чем ожидалось",
        "Необходимо системное решение для всех сетевых модулей одновременно"
      ]
    },
    "performance_metrics": {
      "baseline": {
        "compile_errors": "50+ ошибок компиляции",
        "cyclic_dependencies": "3 основных цикла",
        "build_success_rate": "0%"
      },
      "targets": {
        "compile_errors": "0 ошибок",
        "cyclic_dependencies": "0 циклов", 
        "build_success_rate": "100%"
      },
      "actual": {
        "compile_errors": "30+ ошибок (улучшение)",
        "cyclic_dependencies": "0 циклов (исправлено)",
        "build_success_rate": "0% (но прогресс)"
      }
    },
    "next_actions": [
      "Систематически исправить include директории во всех сетевых модулях", 
      "Добавить пути к XKCP заголовкам для crypto-зависимых модулей",
      "Настроить пути к uthash для всех модулей использующих hash tables",
      "Проверить и исправить пути к специфичным заголовкам (dap_server.h, dap_net.h)",
      "Протестировать сборку после каждого исправления"
    ]
  },
  "navigation_system": {
    "purpose": "Задача: Исправление системы сборки DAP SDK: циклические зависимости и заголовочные файлы",
    "recovery_path": ".context/manifest.json",
    "current_file": ".context/tasks/исправление_системы_сборки_dap_sdk_цикли_20250718_195159.json",
    "file_role": "ACTIVE_TASK",
    "related_files": {
      ".context/manifest.json": "Главный навигатор системы",
      "plugins/plugin-python/python-dap/dap-sdk/CMakeLists.txt": "Основной файл сборки DAP SDK"
    },
    "quick_navigation": {
      "🏠 Главная": ".context/manifest.json - главный навигатор системы",
      "📋 Задачи": ".context/tasks/ - управление задачами", 
      "🛠️ CLI": ".context/tools/scripts/slc_cli.py - автоматизация"
    },
    "usage_hint": "./slc list для просмотра всех задач проекта",
    "ai_context": "Активная задача СЛК: Исправление системы сборки DAP SDK с детальной декомпозицией"
  }
}